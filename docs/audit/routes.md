# Карта роутов и экранов

## Структура роутинга

Приложение использует React Router v6 с вложенными маршрутами и защищенными роутами.

### Основные роуты

| Путь | Компонент | Тип | Описание | Параметры |
|------|-----------|-----|----------|-----------|
| `/login` | `LoginPage` | Публичный | Страница входа | - |
| `/register` | `RegisterPage` | Публичный | Страница регистрации | - |
| `/` | `Layout` (с `ProtectedRoute`) | Защищенный | Главная страница с дашбордом | - |
| `/workspace/:workspaceId` | `WorkspacePage` | Защищенный | Страница рабочего пространства | `workspaceId` |
| `/workspace/:workspaceId/settings` | `WorkspaceSettingsPage` | Защищенный | Настройки workspace | `workspaceId` |
| `/workspace/:workspaceId/page/:pageId` | `PageEditor` | Защищенный | Редактор страниц | `workspaceId`, `pageId` |
| `/workspace/:workspaceId/tasks/:boardId` | `TaskBoardPage` | Защищенный | Доска задач | `workspaceId`, `boardId` |
| `/workspace/:workspaceId/database/:databaseId` | `DatabasePage` | Защищенный | База данных | `workspaceId`, `databaseId` |
| `/settings` | `SettingsPage` | Защищенный | Настройки пользователя | - |
| `*` | `Navigate to="/"` | - | 404 редирект | - |

### Вложенная структура

```
/ (Layout + ProtectedRoute)
├── / (DashboardPage) - Главная страница
├── /workspace/:workspaceId (WorkspacePage) - Рабочее пространство
│   ├── /settings (WorkspaceSettingsPage) - Настройки workspace
│   ├── /page/:pageId (PageEditor) - Редактор страниц
│   ├── /tasks/:boardId (TaskBoardPage) - Доска задач
│   └── /database/:databaseId (DatabasePage) - База данных
└── /settings (SettingsPage) - Настройки пользователя
```

## Компоненты страниц

### Публичные страницы

#### LoginPage (`/login`)
- **Функционал**: Аутентификация пользователя
- **Особенности**: 
  - Редирект на главную при успешном входе
  - Модальное окно восстановления пароля
  - Кнопки социальной авторизации (Google, GitHub) - **НЕ РЕАЛИЗОВАНЫ**
- **Состояние**: Полностью реализована

#### RegisterPage (`/register`)
- **Функционал**: Регистрация нового пользователя
- **Особенности**: Валидация совпадения паролей
- **Состояние**: Полностью реализована

### Защищенные страницы

#### DashboardPage (`/`)
- **Функционал**: Главная страница с обзором и быстрыми действиями
- **Особенности**:
  - Статистика по workspace (страницы, базы данных, задачи, участники)
  - Быстрые действия (создание страницы, БД, доски задач)
  - Последняя активность
  - Предстоящие задачи (заглушка)
- **Состояние**: Частично реализована (есть заглушки)

#### WorkspacePage (`/workspace/:workspaceId`)
- **Функционал**: Управление содержимым workspace
- **Особенности**:
  - Табы: Страницы, Базы данных, Доски задач, Шаблоны, Архив
  - Панель комментариев
  - Кнопка настроек workspace
- **Состояние**: Полностью реализована

#### PageEditor (`/workspace/:workspaceId/page/:pageId`)
- **Функционал**: Редактирование страниц с богатым текстом
- **Особенности**:
  - Автосохранение с индикатором статуса
  - Режимы просмотра/редактирования
  - Модальное окно шаринга
  - Богатый текстовый редактор (Tiptap)
- **Состояние**: Полностью реализована

#### TaskBoardPage (`/workspace/:workspaceId/tasks/:boardId`)
- **Функционал**: Управление задачами
- **Особенности**:
  - Условный рендеринг: KanbanBoard или TaskBoardsList
  - Зависит от наличия boardId
- **Состояние**: Полностью реализована

#### DatabasePage (`/workspace/:workspaceId/database/:databaseId`)
- **Функционал**: Управление базами данных
- **Особенности**:
  - Множественные представления: таблица, сетка, календарь, канбан, галерея
  - Управление свойствами БД
  - Создание записей
  - Условный рендеринг: DatabasesList или DatabasePage
- **Состояние**: Полностью реализована

#### SettingsPage (`/settings`)
- **Функционал**: Настройки пользователя
- **Особенности**:
  - Табы: Профиль, Уведомления, Безопасность
  - Загрузка аватара
  - Смена пароля
  - Настройки уведомлений
- **Состояние**: Полностью реализована

#### WorkspaceSettingsPage (`/workspace/:workspaceId/settings`)
- **Функционал**: Настройки workspace
- **Особенности**: Обертка над компонентом WorkspaceSettings
- **Состояние**: Полностью реализована

## Навигация

### Sidebar навигация
- **Главная** (`/`) - всегда доступна
- **Настройки** (`/settings`) - всегда доступна
- **Workspace-специфичные** (при наличии workspaceId):
  - Страницы (`/workspace/:workspaceId`)
  - Базы данных (`/workspace/:workspaceId/databases`) - **НЕ НАЙДЕНО в роутах**
  - Доски задач (`/workspace/:workspaceId/tasks`) - **НЕ НАЙДЕНО в роутах**
  - Настройки (`/workspace/:workspaceId/settings`)

### Проблемы с навигацией

1. **Несоответствие роутов**: В Sidebar есть ссылки на `/workspace/:workspaceId/databases` и `/workspace/:workspaceId/tasks`, но в App.tsx таких роутов нет
2. **Отсутствие 404 страницы**: Все неизвестные роуты редиректят на главную
3. **Заглушки в DashboardPage**: Предстоящие задачи - статичные данные

## Защита роутов

### ProtectedRoute
- **Функционал**: Проверка аутентификации пользователя
- **Поведение**: 
  - Показывает загрузку при проверке
  - Редирект на `/login` если не авторизован
- **Состояние**: Полностью реализована

### Провайдеры
- **AuthProvider**: Управление состоянием аутентификации
- **ThemeProvider**: Управление темой
- **QueryClientProvider**: React Query для серверного состояния

## Состояние реализации

| Компонент | Статус | Проблемы |
|-----------|--------|----------|
| LoginPage | ✅ Готов | Кнопки соц. авторизации не работают |
| RegisterPage | ✅ Готов | - |
| DashboardPage | ⚠️ Частично | Заглушки в предстоящих задачах |
| WorkspacePage | ✅ Готов | - |
| PageEditor | ✅ Готов | - |
| TaskBoardPage | ✅ Готов | - |
| DatabasePage | ✅ Готов | - |
| SettingsPage | ✅ Готов | - |
| WorkspaceSettingsPage | ✅ Готов | - |
| ProtectedRoute | ✅ Готов | - |

## Рекомендации

1. **Исправить навигацию**: Добавить недостающие роуты или убрать ссылки из Sidebar
2. **Добавить 404 страницу**: Создать компонент NotFoundPage
3. **Реализовать соц. авторизацию**: Google и GitHub кнопки
4. **Убрать заглушки**: Заменить статичные данные на реальные API вызовы
5. **Добавить lazy loading**: Для оптимизации загрузки страниц
